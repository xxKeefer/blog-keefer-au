---
title: Testing in Typescript
description: A little bit of functional programming makes testing easy
tags:
  - testing
  - typescript
  - jest
  - vitest
publishedDate: '2025-04-05'
---

import { StatusTableDemo } from '~/demos/gizmos/StatusTable/StatusTableDemo'

# A tricky state to be in

Recently at my job I was asked to make a cell in a table that would indicate the state of some widget documented on that particular row. Now a widget has various gizmos that all contribute to it's state and each device could be in one of many states.

My job to make some UI that showed an icon the represented that state. Simple enough, until you realize that the widget's state depends on multiple gizmos attached to the widget. Some of which could be in a `fail safe` mode, and if that isn't the case the states it could be in are Ok, Unknown, Fault, Failed or Disabled. And if the gizmo was Disabled, that command had come from a parent system we had no control over and that was to be considered to be Ok. Oh, also if it has an override on the gizmo then it should display an additional icon showing that, so a lot of requirements and a fairly complex piece of UI.

<StatusTableDemo />

## What goes in must come out

Now the implementation of this UI is not important for what I want to share. I did not ''enjoy testing things until recently. What i want to share is a pattern i have developed for testing my code with Jest or Vitest _(their api's are essentially the same)_. Prior to this i had always found it so cumbersome to write case after case of tests. That was util I finally understood `test.each`.

```ts
type GizmoData = {
  failSafe?: boolean
  override?: boolean
  state: 'Ok' | 'Unknown' | 'Fault' | 'Failed' | 'Disabled'
}

test.each<{
  // this could be a tag to make it easier to search for
  // or even used in the description
  _note?:string;
  // this could be props, function parameter whatever you want
  // or need to test a scenario
  inputs:GizmoData;
  // this can also be anything, the function output,
  // variables you need to check the ui anything
  assert:{
    statusIcon:string
    overrideIcon:string
  };
}>([
  {
    failSafe: true,
    override: true,
    state: 'Fault',
  },
  ...
], "for inputs: $inputs, the assertions are true", ({_note, inputs, assert})=>{

})
```
